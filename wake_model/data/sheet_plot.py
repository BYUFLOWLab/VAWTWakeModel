from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm
from matplotlib.ticker import LinearLocator, FormatStrFormatter
import matplotlib.pyplot as plt
import numpy as np
from numpy import exp,sqrt,pi,fabs
from VAWT_Wake_Model import velocity_field
from database_call import velocity
import csv
from matplotlib import rcParams
rcParams['font.family'] = 'Times New Roman'

def overlay(xt,ys,coef):
    a = coef[0]
    b = coef[1]
    c = coef[2]
    d = coef[3]
    e = coef[4]
    f = coef[5]
    g = coef[6]
    h = coef[7]
    i = coef[8]
    j = coef[9]

    return a + b*xt + c*ys + d*xt**2 + e*xt*ys + f*ys**2 + g*xt**3 + h*xt**2*ys + i*xt*ys**2 + j*ys**3



coef0 = np.array( [85.85603842892722, -31.265541600207925, -186.32352551519685, 4.755843637610657, 31.728661896901674, 190.59514965223653, -0.26655398669047137, -1.5782309302740138, -11.16510479093, -75.27051793387098] )
coef1 = np.array( [-1.889919107147009, 2.451967006193321, 12.661430359851664, -0.19411313695074053, -0.7869220280987795, -8.529336341733336, 0.0, 0.0, 0.0, 0.0] )
coef2 = np.array( [0.7163928408654102, -0.2099582112195102, -1.5130991572013264, 0.014453728724008469, 0.29458963597781135, 0.5881199130861473, 0.0, 0.0, 0.0, 0.0] )
coef3 = np.array( [-4.076293735967472, 1.7990665307521179, 10.08684353245236, -0.1663558509608153, -1.7054037162704765, -4.292519524395635, 0.003912364719248771, 0.06142324569062516, 0.25347600970158063, 0.0] )
coef4 = np.array( [1.0381242343230948, -0.509314954804111, 0.06925783207205706, 0.08525792401817142, 0.05880685351481228, -0.5946611471733877, -0.004771444342553006, -0.01435956350128612, 0.11823590390453657, 0.0] )
coef5 = np.array( [-1.5018496141017106, 1.9068315509262075, 11.817176284427166, -0.27248503084292175, -6.760325537449308, -12.479823496054642, 0.0, 0.46763001246623787, 3.770015533669974, 3.7225954618140453] )
coef6 = np.array( [0.6861485518161511, -0.14315960111069143, -0.22268002551006286, 0.024508369680492796, -0.06382389976256997, 0.4325115553064423, -0.0016226170404684648, 0.010892318395201923, 0.043192316628226736, -0.29406536557835233] )
coef7 = np.array( [-0.047764323347271494, 0.025074337755412207, -0.031118085191616327, -0.005140067004508166, 0.17836666180706653, -0.10726565471947522, 0.000541190218311541, -0.00923234110893999, -0.028877561626612917, 0.1441416170707278] )
coef8 = np.array( [39.26779630599696, -6.585968187369011, -22.69572348693566, 0.9838153652433007, -4.310752856959771, 10.292483098058833, -0.0674520821777008, 0.3412301854939842, 2.5654792490994036, -4.664508878378583] )


coef0 = np.array( [110.36030047488595, -27.985029641159635, -317.9413884301561, 1.878631951546971, 56.098972269155766, 312.4289628464063, 0.0, -2.0059698573093683, -27.32200171079657, -100.17261139540484] )
coef1 = np.array( [1.1862973344821859, 3.2913660782457277, -13.343558670695955, -0.6994710704769485, 2.755577535790919, 24.41590484609918, 0.04455378755559768, 0.07032158254873834, -3.7862576950238216, -8.720769026464755] )
coef2 = np.array( [0.1255751578337351, -0.023873145621841157, -1.1731644110837747, 0.0, 0.21525685130206756, 1.6926888990773763, 0.0, 0.0, -0.13006998640696732, -0.7203847208910938] )
coef3 = np.array( [0.604604570567267, -0.23669313806774606, -0.34190928626245876, 0.028525238398903852, 0.1626346287030023, -0.3025727427349951, -0.0010750324435612887, -0.011521887892891916, -0.018045156540234433, 0.21032697191920527] )

coef3 = np.array([7.113,-2.176,-12.96,0.2719,1.954,10.07,-0.01145,-0.1224,-0.4025,-3.395])
coef4 = np.array( [-2.1579735618906395, 3.8231906624406182, 6.203244641496877, -0.9977766045457122, -5.480607527455324, 0.0, 0.06455330726056291, 0.6226831089712495, 0.0, 0.0] )
coef5 = np.array( [0.9956179768896047, -0.1851658632946506, -1.1667623179247888, 0.010377359343377409, 0.2551128576510571, 0.5398026250286322, 0.0002202373562505837, -0.006404037687646303, -0.07055287805082666, 0.0] )
coef6 = np.array( [0.042251377261527216, -0.03314023685276692, -0.2132999223735087, 0.007497085100377211, 0.21850016639856837, 0.16869202696085084, -0.0003310698528521071, -0.012647244265627924, -0.04544937719634106, 0.0] )
coef7 = np.array( [39.34005307348499, -4.563877850653355, -36.29775209491077, 0.215754042224762, 1.3565208067720742, 12.914792852294092, 0.0, 0.0, 0.0, 0.0] )





n = 100
x = np.linspace(1.5,7.,n)
y = np.linspace(0.15,1.0,n)


fs = 15
fig = plt.figure(1,figsize=(10,6))
fig.subplots_adjust(bottom=0,left=0,right=1,top=1)
ax = fig.gca(projection='3d')
X, Y = np.meshgrid(x, y)
G = np.zeros((n,n))
H = np.zeros((n,n))

for i in range(n):
    for j in range(n):
        G[i,j] = overlay(X[i,j],Y[i,j],coef3)
        # H[i,j] = overlay(X[i,j],Y[i,j],coef4)

surf = ax.plot_surface(X, Y, G, rstride=1, cstride=1, color='g', linewidth=0, antialiased=True, alpha=0.5, label='SMG Surface')#cmap=cm.parula
# surf = ax.plot_surface(X, Y, H*100., rstride=1, cstride=1, color='b', linewidth=0, antialiased=True, alpha=0.5, label='SMG Surface')#cmap=cm.parula
# surf = ax.plot_surface(X, Y, np.ones_like(G)*0., rstride=1, cstride=1, color='r', linewidth=0, antialiased=True, alpha=0.5, label='SMG Surface')#cmap=cm.parula
# ax.azim = -160
# ax.elev = 35
ax.set_xlabel('TSR',fontsize=fs)
ax.set_ylabel('Solidity',fontsize=fs)
ax.set_zlabel('Value',fontsize=fs)
# ax.set_xlim(0,20)
# ax.set_ylim(-2,2)
# ax.set_zlim(0,1.2)
# ax.set_xticklabels(np.array([0,5,10,15,20]),fontsize=fs)
# ax.set_yticklabels(np.array([-2.0,-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5,2.0]),fontsize=fs)
# ax.set_zticklabels(np.array([0.0,0.2,0.4,0.6,0.8,1.0]),fontsize=fs)



plt.show()